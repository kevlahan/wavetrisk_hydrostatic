INSTRUCTIONS FOR COMPILING, RUNNING AND POST-PROCESSING

TO COMPILE (example):
mkdir build
make TEST_CASE=Held_Suarez PARAM=param_J5 ARCH=mpi-lb

Selects Held_Suarez test case, J=5 coarsest grid and load balancing parallel (mpi) version. Can use "make clean" to ensure a clean build.

!! Always do "make clean" when compiling a new test case !!

Note that code requires LAPACK library. Each test case is defined by three files in subdirectories of test directory.

TO RUN (using test case DCMIP2012c4 as an example):
cd to-working_directory                                  (move to working directory, mkdir if necessary)
ln -s wavetrisk_hydrostatic/bin/DCMIP2012c4 .            (provide symbolic link to executable)
ln -s path-to-grid_HR .                                  (provide symbolic link to Heikes and Randall grids, if using)
cp wavetrisk_hydrostatic/test/DCMIP2012c4/test_case.in . (copy parameters files and then edit as appropriate)
mpirun -n 40 DCMIP2012c4 > log &                         (run on 40 processors using mpi)


POST-PROCESS SAVED FIELDS (e.g. DCMIP2012c4.1... and DCMIP2012c4.2...) FOR PARAVIEW:

cd post
gfortran -o trisk2vtk trisk2vtk.f90
cd to-working-directory
ln -s wavetrisk_hydrostatic/post/trisk2vtk .
trisk2vtk DCMIP2012c4.1 primal 0 10 5 8 out (generates .vtk files for the saved primal grid fields 0 to 10 at scales j = 5:8 and saves in files out...vtk)
trisk2vtk DCMIP2012c4.2 dual   0 10 5 8 out (generates .vtk files for the saved primal grid fields 0 to 10 at scales j = 5:8 and saves in files out...vtk)


POST-PROCESS CHECKPOINTS FOR MATLAB PLOTTING OF 2-D PROJECTIONS ON LONGITUDE-LATITUDE PLANE:

make TEST_CASE=flat_projection_data PARAM=param_J5 ARCH=mpi-lb    (make the code to post process the 2d projections)
cd to-working_directory                                           (move to working directory)
ln -s wavetrisk_hydrostatic/bin/flat_projection_data .            (provide symbolic link to executable)    
ln -s path-to-grid_HR .                                           (provide symbolic link to Heikes and Randall grids, if using)
cp wavetrisk_hydrostatic/test/flat_projection_data/test_case.in . (copy parameters files and then edit as appropriate)
mpirun -n 40 flat_projection_data > log &                         (run on 40 processors using mpi)

Then post-process using the matlab file wavetrisk_hydrostatic/post/plat_2d.m, which also plots data for the log file DCMIP2012c4_log.

FURTHER INFORMATION ABOUT THE CODE IS GIVEN AT THE START OF src/shared.f90.



